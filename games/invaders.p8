pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- INVADERS
-- BY ADAM RICHARDSON
player={x=0,y=120,w=11,h=8}
score=0
lives=0
ufo={x=-20,y=10,w=16,h=8}
enemy_ticks=40
ticks=0
enemy_state=false
pb={
	x=0,
	y=120,
	w=1,
	h=4,
	speed=3,
	active=false}
	
function _init()
	cls()
	-- ufo
	spr(32,ufo.x,ufo.y,2,1)
	
	-- enemies
	for i=0,6 do
		spr(4,i*16,20)
		spr(0,i*16,30,2,1)
		spr(0,i*16,40,2,1)
		spr(6,i*16,50,2,1)
		spr(6,i*16,60,2,1)
	end
	-- player
	spr(10,player.x,player.y,2,1)
	
	-- sheilds
	for i=0,3 do
		spr(34,8+i*32,100,2,2)
	end
end

function update_enemies()
	enemy_state=not enemy_state
	local a_spr=4
	local b_spr=0
	local c_spr=6
	if enemy_state then
		a_spr=5
		b_spr=2
		c_spr=8	 
	end
	for i=0,6 do
		rectfill(i*16,20,(i+1)*16,28,0)
		rectfill(i*16,30,(i+1)*16,38,0)
		rectfill(i*16,40,(i+1)*16,48,0)
		rectfill(i*16,50,(i+1)*16,58,0)
		rectfill(i*16,60,(i+1)*16,68,0)
		spr(a_spr,i*16,20)
		spr(b_spr,i*16,30,2,1)
		spr(b_spr,i*16,40,2,1)
		spr(c_spr,i*16,50,2,1)
		spr(c_spr,i*16,60,2,1)
	end
end

function _update60()
	ticks+=1
	if ticks>=enemy_ticks then
		ticks=0
		update_enemies()
	end
	
	if btn(0) then
		rectfill(
			player.x,
			player.y,
			player.x+player.w,
			player.y+player.h,0)
		player.x-=1
		player.x=max(0,player.x)
		spr(10,player.x,player.y,2,1)
	end
	
	if btn(1) then
		rectfill(
			player.x,
			player.y,
			player.x+player.w,
			player.y+player.h,0)
		player.x+=1
		player.x=min(128-player.w,player.x)
		spr(10,player.x,player.y,2,1)
	end
	
	rectfill(
		ufo.x,
		ufo.y,
		ufo.x+ufo.w,
		ufo.y+ufo.h,0)
	ufo.x+=1
	spr(32,ufo.x,ufo.y,2,1)
	if ufo.x>128 then
		ufo.x=-20
	end
	
	if pb.active then
		rectfill(
			pb.x,
			pb.y,
			pb.x,
			pb.y+pb.h,0)
		pb.y-=pb.speed
		rectfill(
			pb.x,
			pb.y,
			pb.x,
			pb.y+pb.h,11)
		if pb.y==10 then
			rectfill(
				pb.x,
				pb.y,
				pb.x,
				pb.y+pb.h,0)
				pb.active=false
			
		end
	end
	
	if btnp(5) and not pb.active then
		pb.active=true
		pb.y=115
		pb.x=player.x+5
	end
end

function _draw()
	rectfill(0,0,128,10,0)
	-- info
	print("score "..score,45,2,7)
	spr(10,104,0,2,1)
	print("="..lives,116,2,7)
		
	-- stats
	print(stat(1),0,2,7)
end

__gfx__
0070000070000000007000007000000000077000000770000000777700000000000077770000000000000b000000000000000000000000000000000000000000
000700070000000070070007007000000077770000777700077777777770000007777777777000000000bbb00000000000000000000000000000000000000000
007777777000000070777777707000000777777007777770777777777777000077777777777700000000bbb00000000000000000000000000000000000000000
077077707700000077707770777000007707707777077077777007700777000077700770077700000bbbbbbbbb00000000000000000000000000000000000000
77777777777000000777777777000000777777777777777777777777777700007777777777770000bbbbbbbbbbb0000000000000000000000000000000000000
70777777707000000077777770000000070770700070070000777007770000000007700770000000bbbbbbbbbbb0000000000000000000000000000000000000
70700000707000000070000070000000700000070707707007700770077000000077077077000000bbbbbbbbbbb0000000000000000000000000000000000000
00077077000000000700000007000000070000707070070700770000770000007700000000770000bbbbbbbbbbb0000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000088888800000000bbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000888888888800000bbbbbbbbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00888888888888000bbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0880880880880880bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8888888888888888bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0088800880088800bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008000000008000bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bbbbbb0000bbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bbbbb000000bbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bbbb00000000bbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bbbb00000000bbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100001f050260502b050000000000000000000000000000000000001e000230002d0002b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000100002a65028650266502465024650206500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
